<div class="w-100">
  <section class="d-flex justify-content-center align-items-end gap-2 mt-2 mb-4">
    <h2 class="title">
      <%- include('../icons/tasks-icon'); %>
      <span>
        <%= t('list') %>
      </span>
    </h2>
  </section>

  <form class="needs-validation mb-5" method="get" action="/data/audittrails" autocomplete="off" novalidate>
    <input class="form-control" type="text" id="keyword" name="keyword" maxlength="50" value="<%= locals.keyword %>" placeholder="<%= t('keyword') %>" />
    <div class="datepicker-wrapper">
      <i><%- include('../icons/calendar-icon'); -%></i>
      <input type="text" id="dateRange" name="dateRange" role="dateRange" placeholder="<%= t('startDate') + ' - ' + t('endDate') %>" readonly />
    </div>
    <div class="d-flex gap-2 my-3">
      <button type="reset" class="btn btn-secondary">
        <i class="icon" style="width: 18px; height: 18px;"><%- include('../icons/reload-icon'); -%></i>
        <span><%= t('reset') %></span>
      </button>
      <button type="submit" class="btn btn-primary">
        <i class="icon" style="width: 20px; height: 20px;"><%- include('../icons/search-icon'); -%></i>
        <span><%= t('search') %></span>
      </button>
    </div>
  </form>

  <% if(locals.data && locals.data.length > 0) { %>
  <div class="table-responsive">
    <table class="table table-striped table-hover border-top">
      <thead>
        <tr>
          <th scope="col">#</th>
          <th scope="col"><%= t('createdAt') %></th>
          <th scope="col"><%= t('url') %></th>
          <th scope="col"><%= t('method') %></th>
        </tr>
      </thead>
      <tbody>
        <% data.forEach((row, index)=> { %>
        <tr>
          <td>
            <span class="table-text"> <%= index + locals.pagination.firstRowNumber %> </span>
          </td>
          <td data-convertToDatetime><%= row.createdAt %></td>
          <td><%= row.url %></td>
          <td><%= row.method %></td>
        </tr>
        <% }); %>
      </tbody>
    </table>
  </div>

  <section class="pagination-wrapper">
    <div class="pagination-label"><%= t('paginationLabel', locals.pagination.page, locals.pagination.totalPage) %></div>
    <ul class="pagination">

      <% if (locals.pagination.firstQueryString) { %>
      <li class="page-item">
        <a class="page-link" href="/data/audittrails?<%= locals.pagination.firstQueryString %>"><%- include('../icons/first-icon'); -%></a>
      </li>
      <% } else { %>
      <li class="page-item disabled cursor-not-allowed">
        <span class="page-link"><%- include('../icons/first-icon'); -%></span>
      </li>
      <% } %>

      <% if (locals.pagination.previousQueryString) { %>
      <li class="page-item">
        <a class="page-link" href="/data/audittrails?<%= locals.pagination.previousQueryString %>"><%- include('../icons/previous-icon'); -%></a>
      </li>
      <% } else { %>
      <li class="page-item disabled cursor-not-allowed">
        <span class="page-link"><%- include('../icons/previous-icon'); -%></span>
      </li>
      <% } %>

      <% if (locals.pagination.nextQueryString) { %>
      <li class="page-item">
        <a class="page-link" href="/data/audittrails?<%= locals.pagination.nextQueryString %>"><%- include('../icons/next-icon'); -%></a>
      </li>
      <% } else { %>
      <li class="page-item disabled cursor-not-allowed">
        <span class="page-link"><%- include('../icons/next-icon'); -%></span>
      </li>
      <% } %>

      <% if (locals.pagination.lastQueryString) { %>
      <li class="page-item">
        <a class="page-link" href="/data/audittrails?<%= locals.pagination.lastQueryString %>""><%- include('../icons/last-icon'); -%></a>
      </li>
      <% } else { %>
      <li class=" page-item disabled cursor-not-allowed">
          <span class="page-link"><%- include('../icons/last-icon'); -%></span>
      </li>
      <% } %>

    </ul>
  </section>
  <% } else { %>
  <div class=" empty-data text-secondary bg-light-subtle border">
    <%- include('../icons/empty-icon'); -%>
    <p>
      <%= t('noRecords') %>
    </p>
  </div>
  <% } %>

</div>

<script>
  window.addEventListener('load', () => {
    window.initDateRangePicker("<%= locals.startDate %>", "<%= locals.endDate %>");
  });
</script>